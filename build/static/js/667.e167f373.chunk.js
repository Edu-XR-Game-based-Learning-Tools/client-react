"use strict";(self.webpackChunkreact_gblt=self.webpackChunkreact_gblt||[]).push([[667],{1391:function(e,n,t){t.d(n,{Z:function(){return l}});var i=t(2791),r=t(6579),o=(t(8741),t(1354)),l=function(){var e=(0,r.T)(),n=(0,r.C)(o.lD);return{quizList:n.quizCollectionList,editQuiz:n.editCollection,getQuizCollectionList:(0,i.useCallback)((function(){e(o.eI.getQuizCollectionList())}),[e]),getQuizCollection:(0,i.useCallback)((function(n){e(o.eI.getQuizCollection(n))}),[e]),updateQuizCollection:(0,i.useCallback)((function(n){e(o.eI.updateQuizCollection(n))}),[e]),deleteQuizCollection:(0,i.useCallback)((function(n){e(o.eI.deleteQuizCollection(n))}),[e])}}},667:function(e,n,t){t.r(n),t.d(n,{default:function(){return B}});var i=t(3433),r=t(1413),o=t(4165),l=t(5861),s=t(9439),u=t(7630),a=t(9218),c=t(4554),d=t(3400),f=t(1889),h=t(890),x=t(3768),g=t(6151),Z=t(9953),m=t(2460),p=t(427),j=t(7),z=t(1258),v=t(276),b=t(2686),C=t(2791),w=t(8687),y=t(7689),k=t(8537),q=t(742),I=t(1391),E=t(9224),R=t(1563),L=t(6530);function P(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=(0,C.useContext)(y.UNSAFE_NavigationContext).navigator;(0,C.useEffect)((function(){if(!n)return function(){};var i=t.block((function(n){var t=(0,r.Z)((0,r.Z)({},n),{},{retry:function(){i(),n.retry()}});e(t)}));return i}),[t,e,n])}((0,C.useCallback)((function(n){window.confirm(e)&&n.retry()}),[e]),n)}var D=t(6579),S=t(4259),Q=t(184),A=function(e){var n=e.file,t=void 0===n?null:n,i=e.url,r=void 0===i?null:i,o=(0,C.useRef)(null),l=(0,C.useRef)(null),u=(0,C.useRef)(!0),a=(0,C.useState)(!1),c=(0,s.Z)(a,2),d=c[0],f=c[1];return(0,C.useEffect)((function(){d||(u.current=!0)}),[d]),(0,C.useEffect)((function(){if((t||r)&&(b.EoE("libs"),b.CxH(null),null===l.current)){var e=new b.SLE(o.current,{backgroundColor:new b.klI(255,255,255,0),defaultColor:new b.vho(255,255,255),edgeSettings:new b.omR(!1,new b.vho(255,255,255),1),onModelLoaded:function(){console.log(l.current.GetViewer())}});if(e.Resize=function(){console.log("I'm not resizing")},l.current=e,t){var n=new DataTransfer;console.log(t),n.items.add(t);var i=Array.from(n.files);e.LoadModelFromFileList(i)}else if(r){var s=r.split("."),a=s[s.length-1].split("?")[0],c=[new b.htq("filename.".concat(a),b.UoQ.Url,r)];e.LoadModelFromInputFiles(c),u.current&&(u.current=!1,f((function(e){return!e})))}}return function(){if(null!==l.current&&null!==o.current){delete l.current.model,l.current.viewer.renderer.resetState(),l.current.viewer.Clear(),l.current.canvas.getContext("webgl2").getExtension("WEBGL_lose_context").loseContext();var e=l.current.canvas.cloneNode(!0);l.current.canvas.parentNode.replaceChild(e,l.current.canvas),o.current.removeChild(o.current.children[0]),l.current=null}}}),[t,r,d]),(0,Q.jsx)(Q.Fragment,{children:(0,Q.jsx)("div",{style:{display:"flex",justifyContent:"right",width:"100%",height:"100%"},ref:o,role:"img","aria-label":"Canvas showing the model in the 3D Viewer",className:"relative flex  flex-col items-center justify-center p-2 h-72 w-72 border-2 border-black rounded-sm"})})},F=(0,u.ZP)(a.Z)({"& input:valid + fieldset":{borderColor:"#E0E3E7",borderWidth:1},"& input:invalid + fieldset":{borderColor:"red",borderWidth:1},"& input:valid:focus + fieldset":{borderLeftWidth:4,padding:"4px !important"}}),N=[m.Z[500],p.Z[500],j.Z[500],z.Z[500]],T=(0,w.$j)((function(e){return{authData:e.authentication.authData,isLoading:e.global.isLoading,setIsLoading:q.fw.setIsLoading,editCollection:e.quizArchive.editCollection}}))((function(e){var n=(0,C.useRef)(!0),t=(0,y.useParams)().id,u=e.isLoading,m=e.setIsLoading,j=(0,w.v9)((function(e){return e.quizArchive.editCollection})),z=(0,y.useNavigate)(),q=(0,D.T)(),T=(0,I.Z)(),B=T.getQuizCollection,M=T.updateQuizCollection,U=C.useState(S.UW),W=(0,s.Z)(U,2),H=W[0],G=W[1],J=C.useState(0),O=(0,s.Z)(J,2),_=O[0],V=O[1],K=C.useCallback((function(){return H.quizzes[_]}),[H,_]),X={height:"2rem",width:"2rem"},$=C.useState("3d"),Y=(0,s.Z)($,2),ee=Y[0],ne=Y[1],te=C.useState(null),ie=(0,s.Z)(te,2),re=ie[0],oe=ie[1],le=C.useState(null),se=(0,s.Z)(le,2),ue=se[0],ae=se[1],ce=(0,C.useRef)(),de=C.useCallback((function(){return!(re||K().image)}),[K,re]),fe=C.useCallback((function(){return!(ue||K().model)}),[K,ue]);C.useEffect((function(){b.EoE("libs"),b.CxH(null)}),[]),C.useEffect((function(){var e=parseInt(null!==t&&void 0!==t?t:"",10);Number.isNaN(e)?(alert("Invalid Url Params"),z("/")):B(e)}),[q,B,t,z]),C.useEffect((function(){n.current||j.eId||(alert("Invalid Quiz"),z("/")),n.current=!1,oe(null),ae(null),G(j),V((function(e){return e>j.quizzes.length-1?0:e}))}),[j,z]),C.useEffect((function(){H.quizzes.length&&ne(H.quizzes[_].image?"2d":"3d")}),[_,H.quizzes]),P("The changes won't be saved, is it ok?",!C.useCallback((function(){return H===j&&JSON.stringify(H.quizzes)===JSON.stringify(j.quizzes)}),[H,j])());var he=C.useCallback((function(){return JSON.stringify(H.quizzes[_])===JSON.stringify(j.quizzes[_])||window.confirm("The changes won't be saved, is it ok?")}),[_,H.quizzes,j.quizzes]),xe=C.useCallback(function(){var e=(0,l.Z)((0,o.Z)().mark((function e(n){var t,i,r,l;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,E.ig)()){e.next=5;break}return alert("Invalid Token Data"),z("/"),e.abrupt("return",null);case 5:return i=(0,R.HB)("".concat(t.id,"/").concat(n.name)),e.next=8,(0,v.KV)(i,n);case 8:return r=e.sent,e.next=11,(0,v.Jt)(r.ref);case 11:return l=e.sent,e.abrupt("return",l);case 13:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[z]),ge=C.useCallback((0,l.Z)((0,o.Z)().mark((function e(){var n,t,i,l;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],re&&n.push(xe(re)),ue&&n.push(xe(ue)),e.next=5,Promise.all(n);case 5:return t=e.sent,i=H.quizzes.map((function(e,n){return _===n?(0,r.Z)((0,r.Z)({},e),{},{image:re?t[0]:e.image,model:ue?t[t.length-1]:e.model}):e})),l=(0,r.Z)((0,r.Z)({},H),{},{quizzes:i}),e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)}))),[_,H,re,ue,xe]),Ze=C.useCallback((function(){return K().question&&K().question.trim()?!K().answers||K().answers.filter((function(e){return e.trim()})).length<2?"At least two non-empty answers should be filled":!K().duration||K().duration<10||K().duration>240?"Duration should be between 10 and 240 seconds":de()&&fe()?"Quiz should contains at least image or model to visualize":"":"Question cannot be empty"}),[K,de,fe]),me=C.useCallback((0,l.Z)((0,o.Z)().mark((function e(){var n,t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=Ze())){e.next=4;break}return alert(n),e.abrupt("return");case 4:return q(m(!0)),e.next=7,ge();case 7:t=e.sent,M(t),q(m(!1));case 10:case"end":return e.stop()}}),e)}))),[Ze,q,m,ge,M]),pe=C.useCallback((0,l.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.confirm("Are you sure you want to delete this question?")&&G((function(e){var n=null===e.quizzes[_].eId,t=e.quizzes.filter((function(e,n){return _!==n})),i=(0,r.Z)((0,r.Z)({},e),{},{quizzes:t});return n||M(i),V((function(e){return e>t.length-1?0:e})),i}));case 1:case"end":return e.stop()}}),e)}))),[_,M]),je=C.useCallback((function(){"3d"===ee?ue?ae(null):G((function(e){var n=e.quizzes.map((function(e,n){return _===n?(0,r.Z)((0,r.Z)({},e),{},{model:null}):e}));return(0,r.Z)((0,r.Z)({},e),{},{quizzes:n})})):re?oe(null):G((function(e){var n=e.quizzes.map((function(e,n){return _===n?(0,r.Z)((0,r.Z)({},e),{},{image:null}):e}));return(0,r.Z)((0,r.Z)({},e),{},{quizzes:n})}))}),[_,re,ue,ee]),ze=C.useState(!1),ve=(0,s.Z)(ze,2),be=ve[0],Ce=ve[1],we="left",ye=C.useCallback((function(e){Ce(e)}),[]),ke=C.useCallback((function(){he()&&(G((function(e){return(0,r.Z)((0,r.Z)({},e),{},{quizzes:[].concat((0,i.Z)(e.quizzes),[S.BE])})})),V(H.quizzes.length),ye(!1))}),[he,H.quizzes.length,ye]),qe=function(){return(0,Q.jsx)(c.Z,{display:"flex",justifyContent:"center",style:{marginTop:"0.5rem"},children:(0,Q.jsxs)(d.Z,{onClick:ke,style:{width:"100%",borderRadius:"0"},children:[H.quizzes.length>0?"":"Empty Quiz, Add?",(0,Q.jsx)(k.Z.AddIcon,{})]})})},Ie=C.useCallback((function(e){he()&&(V(e),ye(!1))}),[he,ye]),Ee=function(){return(0,Q.jsx)(C.Fragment,{children:(0,Q.jsx)(Z.ZP,{anchor:we,open:be,onClose:function(){return ye(!1)},children:(0,Q.jsxs)(c.Z,{sx:{width:"25vw"},children:[H.quizzes.length>0?H.quizzes.map((function(e,n){return function(e){var n=H.quizzes[e];return(0,Q.jsxs)(f.ZP,{container:!0,children:[(0,Q.jsxs)(f.ZP,{item:!0,xs:2,display:"flex",flexDirection:"column",justifyContent:"space-between",children:[(0,Q.jsxs)(h.Z,{textAlign:"center",children:[e+1,".",n.name]}),(0,Q.jsx)(x.Z,{title:"Delete question",children:(0,Q.jsx)(d.Z,{children:(0,Q.jsx)(k.Z.DeleteIcon,{})})})]}),(0,Q.jsx)(f.ZP,{item:!0,xs:10,children:(0,Q.jsx)(g.Z,{variant:"text",onClick:function(){return Ie(e)},style:{width:"100%"},children:(0,Q.jsxs)(f.ZP,{display:"flex",flexDirection:"column",style:{width:"100%"},children:[(0,Q.jsx)("img",{width:"100%",style:{aspectRatio:"16/9",objectFit:"contain"},alt:"image-banner",src:n.image}),(0,Q.jsx)(f.ZP,{container:!0,spacing:.5,marginTop:0,children:n.answers.map((function(t,i){return(0,Q.jsx)(f.ZP,{item:!0,xs:6,children:(0,Q.jsx)(c.Z,{width:"100%",padding:.5,sx:{backgroundColor:N[i],aspectRatio:"4/1"},children:i===n.correctIdx?(0,Q.jsx)(c.Z,{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",sx:{aspectRatio:"1/1",borderRadius:"50%",backgroundColor:"white"},children:(0,Q.jsx)(k.Z.CheckIcon,{})}):(0,Q.jsx)(Q.Fragment,{})})},"drawer-answer-".concat(e,"-").concat(i))}))})]})})})]},"drawer-".concat(e))}(n)})):(0,Q.jsx)(Q.Fragment,{}),qe()]})})},we)},Re=function(){var e;return(0,Q.jsxs)(f.ZP,{container:!0,display:"flex",justifyContent:"space-between",padding:"0 2rem",marginBottom:"1rem",children:[(0,Q.jsxs)(c.Z,{children:[(0,Q.jsxs)(h.Z,{display:"inline",paddingX:"1rem",children:["Quiz ID: ",null!==(e=K().eId)&&void 0!==e?e:"-"]}),(0,Q.jsxs)(h.Z,{display:"inline",children:["Question No: ",_+1,"/",H.quizzes.length]}),(0,Q.jsx)("br",{}),(0,Q.jsx)(d.Z,{onClick:function(){return ye(!0)},style:{marginLeft:"0.5rem"},children:be?(0,Q.jsx)(k.Z.KeyboardDoubleArrowLeftIcon,{}):(0,Q.jsx)(k.Z.KeyboardDoubleArrowRightIcon,{})})]}),(0,Q.jsxs)(c.Z,{children:[(0,Q.jsx)(x.Z,{title:"Save",sx:{marginRight:"1rem"},children:(0,Q.jsx)(d.Z,{style:{backgroundColor:"white"},onClick:me,children:(0,Q.jsx)(k.Z.SaveIcon,{style:(0,r.Z)({},X)})})}),(0,Q.jsx)(x.Z,{title:"Delete",children:(0,Q.jsx)(d.Z,{style:{backgroundColor:"white"},onClick:pe,children:(0,Q.jsx)(k.Z.DeleteIcon,{style:(0,r.Z)({},X)})})})]})]})},Le=function(){var e="3d"===ee,n=(0,Q.jsx)(d.Z,{style:{backgroundColor:e?p.Z[300]:"white"},disabled:e,onClick:function(){ne("3d")},children:(0,Q.jsx)(k.Z.ViewInAr,{style:(0,r.Z)({},X)})}),t=(0,Q.jsx)(d.Z,{style:{backgroundColor:e?"white":p.Z[300]},disabled:!e,onClick:function(){ne("2d")},children:(0,Q.jsx)(k.Z.Image,{style:(0,r.Z)({},X)})}),i=function(){return e?"model":"image"},o=e?fe():de(),l=(0,Q.jsx)(x.Z,{title:o?"Add ".concat(i()):"Update ".concat(i()),children:(0,Q.jsx)(d.Z,{style:{backgroundColor:"white"},onClick:function(){return ce.current.click()},children:o?(0,Q.jsx)(k.Z.AddIcon,{style:(0,r.Z)({},X)}):(0,Q.jsx)(k.Z.EditIcon,{style:(0,r.Z)({},X)})})});return(0,Q.jsxs)(f.ZP,{container:!0,spacing:.5,marginTop:0,marginRight:"5rem",direction:"column",flexGrow:1,maxHeight:"60vh",children:[(0,Q.jsxs)(c.Z,{height:"95%",position:"relative",display:"flex",alignItems:"start",justifyContent:o?"center":"right",paddingRight:"1rem",maxHeight:"100%",children:[fe()?(0,Q.jsx)(c.Z,{style:(0,r.Z)((0,r.Z)({},X),{},{alignSelf:"center",display:e?"block":"none"}),children:l}):(0,Q.jsx)(c.Z,{style:{width:"100%",height:"100%",border:"2px solid",position:"absolute",display:e?"block":"none"},children:(0,Q.jsx)(A,{file:ue,url:K().model})}),e?(0,Q.jsx)(Q.Fragment,{}):de()?(0,Q.jsx)(c.Z,{style:(0,r.Z)((0,r.Z)({},X),{},{alignSelf:"center"}),children:l}):(0,Q.jsx)("img",{style:{height:"100%",width:"100%",objectFit:"contain"},src:re?URL.createObjectURL(re):K().image}),(0,Q.jsxs)(c.Z,{position:"absolute",left:"100%",display:"flex",flexDirection:"column",gap:1,children:[e?n:(0,Q.jsx)(x.Z,{title:"3D Model",children:n}),e?(0,Q.jsx)(x.Z,{title:"Image",children:t}):t,l,e&&!fe()||!e&&!de()?(0,Q.jsx)(x.Z,{title:"Remove ".concat(i()),children:(0,Q.jsx)(d.Z,{style:{backgroundColor:"white"},onClick:function(){return je()},children:(0,Q.jsx)(k.Z.DeleteIcon,{style:(0,r.Z)({},X)})})}):(0,Q.jsx)(Q.Fragment,{})]})]}),(0,Q.jsx)("input",{ref:ce,onClick:function(e){e.currentTarget.value=""},onChange:function(n){var t,i;null!==(t=0===(null===(i=n.target.files)||void 0===i?void 0:i.length))&&void 0!==t&&t||(e?ae(n.target.files[0]):oe(n.target.files[0]))},type:"file",hidden:!0,accept:e?".gltf, .fbx, .obj":"image/*"})]})};return(0,Q.jsxs)("div",{children:[0===H.quizzes.length?qe():(0,Q.jsxs)(c.Z,{position:"relative",height:"calc(100vh - 7rem)",minHeight:"calc(100vh - 7rem)",display:"flex",flexDirection:"column",children:[Re(),(0,Q.jsxs)(c.Z,{sx:{display:"flex",flexDirection:"column",paddingLeft:"5rem",flexGrow:1},children:[(0,Q.jsxs)(f.ZP,{container:!0,item:!0,xs:12,spacing:5,sx:{flexGrow:"1 !important"},children:[(0,Q.jsx)(f.ZP,{container:!0,item:!0,xs:5,children:(0,Q.jsx)(f.ZP,{container:!0,spacing:.5,marginTop:0,direction:"column",children:(0,Q.jsx)(f.ZP,{item:!0,xs:8,children:(0,Q.jsx)(a.Z,{type:"text",required:!0,value:K().question,onChange:function(e){G((function(n){var t=n.quizzes.map((function(n,t){return _===t?(0,r.Z)((0,r.Z)({},n),{},{question:e.target.value}):n}));return(0,r.Z)((0,r.Z)({},n),{},{quizzes:t})}))},variant:"outlined",multiline:!0,maxRows:12,sx:{input:{color:"white",height:"100%"},"& .MuiInputBase-root,.MuiInputBase-root:hover":{height:"100%",backgroundColor:"#00000055",color:"white","& > fieldset":{borderColor:"#E0E3E755 !important",borderWidth:1}}},style:{width:"100%"}})})})}),(0,Q.jsx)(f.ZP,{container:!0,item:!0,xs:7,children:Le()})]}),(0,Q.jsx)(f.ZP,{container:!0,item:!0,children:(0,Q.jsx)(f.ZP,{container:!0,rowSpacing:1,columnSpacing:3,marginRight:"5rem",children:K().answers.map((function(e,n){return(0,Q.jsx)(f.ZP,{item:!0,xs:6,children:(0,Q.jsxs)(c.Z,{padding:2,gap:2,sx:{backgroundColor:N[n],height:"8rem",width:"100%",display:"flex",alignItems:"center"},children:[K().correctIdx===n?(0,Q.jsx)(c.Z,{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",sx:{aspectRatio:"1/1",borderRadius:"50%",backgroundColor:"white"},children:(0,Q.jsx)(k.Z.CheckIcon,{})}):(0,Q.jsx)(c.Z,{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",sx:{aspectRatio:"1/1",borderRadius:"50%",backgroundColor:"white",cursor:"pointer"},onClick:function(){G((function(e){var t=e.quizzes.map((function(e,t){return _===t?(0,r.Z)((0,r.Z)({},e),{},{correctIdx:n}):e}));return(0,r.Z)((0,r.Z)({},e),{},{quizzes:t})}))}}),(0,Q.jsx)(a.Z,{type:"text",required:!0,value:K().answers[n],onChange:function(e){G((function(t){var i=t.quizzes[_].answers.map((function(t,i){return n===i?e.target.value:t})),o=t.quizzes.map((function(e,n){return _===n?(0,r.Z)((0,r.Z)({},e),{},{answers:i}):e}));return(0,r.Z)((0,r.Z)({},t),{},{quizzes:o})}))},variant:"outlined",multiline:!0,maxRows:4,sx:{input:{color:"white",height:"100%"},"& .MuiInputBase-root,.MuiInputBase-root:hover":{height:"100%",color:"white","& > fieldset":{borderColor:"#E0E3E755 !important",borderWidth:1}}},style:{width:"100%",height:"100%"}})]})},"answer-".concat(n))}))})})]}),(0,Q.jsx)(c.Z,{position:"absolute",top:"50%",left:0,paddingLeft:"1rem",children:(0,Q.jsx)(F,{id:"timer-validation-input",label:"Timer",type:"number",required:!0,value:K().duration,onChange:function(e){G((function(n){var t=n.quizzes.map((function(n,t){return _===t?(0,r.Z)((0,r.Z)({},n),{},{duration:parseInt(e.target.value,10)}):n}));return(0,r.Z)((0,r.Z)({},n),{},{quizzes:t})}))},variant:"outlined",InputProps:{inputProps:{min:10,max:240}},style:{width:"auto",borderRadius:"1rem"}})}),Ee()]}),(0,Q.jsx)(L.Z,{isLoading:u})]})})),B=function(){return(0,Q.jsx)(Q.Fragment,{children:(0,Q.jsx)(T,{})})}}}]);
//# sourceMappingURL=667.e167f373.chunk.js.map